import{r as e,o as a,b as s,z as l,A as o,I as r,B as t,W as n,R as i,S as u,P as c,_ as p,D as d}from"./vue-core-Bj9NSyid.js";import{u as m}from"./router-B4-DsX-D.js";import{u as v}from"./i18n-Cs-aH8_I.js";import{_ as g,a as f}from"./index-i9U3HkMI.js";import"./vendor-CJNHjaSW.js";import"./state-B_8nituZ.js";import"./mock-CWrnY2TL.js";import"./highlight-C7QV_n3L.js";const y={class:"login-container"},h={class:"login-form"},w={class:"login-title"},k={key:0,class:"error-message"},_={key:1,class:"success-message"},b={class:"form-group"},S={for:"email"},j=["placeholder"],I={key:0,class:"error-text"},x={class:"form-group"},P={for:"password"},V=["placeholder"],W={key:0,class:"error-text"},q=["disabled"],A={key:0},T={key:1,class:"loading-spinner"},U={class:"register-link"},Y=g(Object.assign({name:"登入頁面"},{__name:"LoginView",setup(g){const{t:Y}=v(),z=e=>Y(`auth.${e}`),B=m(),C=e(""),D=e(""),E=e({email:"",password:"",general:""}),F=e(!1),L=e(!1);a((()=>{const e=document.querySelector(".app-container");e&&(e.style.overflowY="auto")})),s((()=>{const e=document.querySelector(".app-container");e&&(e.style.overflowY="hidden")}));const O=async()=>{if((()=>{let e=!0;return E.value={email:"",password:"",general:""},C.value?/\S+@\S+\.\S+/.test(C.value)||(E.value.email=z("message.validEmail"),e=!1):(E.value.email=z("message.noInputWarning"),e=!1),D.value||(E.value.password=z("message.noInputWarning"),e=!1),e})()){F.value=!0,E.value.general="";try{const e=await f.login(C.value,D.value);localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token),localStorage.setItem("token_type",e.token_type),L.value=!0,setTimeout((()=>{B.push("/"),setTimeout((()=>{window.location.reload()}),100)}),1e3)}catch(e){E.value.general=e.message||z("message.loginFailed")}finally{F.value=!1}}},R=()=>{B.push("/register")};return(e,a)=>(d(),l("div",y,[o("div",h,[o("h1",w,t(z("logIn")),1),E.value.general?(d(),l("div",k,t(E.value.general),1)):r("",!0),L.value?(d(),l("div",_," 登入成功！即將跳轉到首頁... ")):r("",!0),L.value?r("",!0):(d(),l("form",{key:2,onSubmit:n(O,["prevent"])},[o("div",b,[o("label",S,t(z("email")),1),i(o("input",{type:"email",id:"email","onUpdate:modelValue":a[0]||(a[0]=e=>C.value=e),class:c({"input-error":E.value.email}),placeholder:z("emailPlaceholder")},null,10,j),[[u,C.value]]),E.value.email?(d(),l("div",I,t(E.value.email),1)):r("",!0)]),o("div",x,[o("label",P,t(z("password")),1),i(o("input",{type:"password",id:"password","onUpdate:modelValue":a[1]||(a[1]=e=>D.value=e),class:c({"input-error":E.value.password}),placeholder:z("passwordPlaceholder")},null,10,V),[[u,D.value]]),E.value.password?(d(),l("div",W,t(E.value.password),1)):r("",!0)]),o("button",{type:"submit",class:"login-button",disabled:F.value},[F.value?(d(),l("span",T)):(d(),l("span",A,t(z("logIn")),1))],8,q),o("div",U,[p(t(z("noAccount")),1),o("a",{href:"#",onClick:n(R,["prevent"])},t(z("register")),1)])],32))])]))}}),[["__scopeId","data-v-f266efc7"]]);export{Y as default};
