<!DOCTYPE html>
<html lang="zh-TW">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>QR Code 庫比較範例</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
				min-height: 100vh;
				padding: 20px;
			}

			.container {
				max-width: 1200px;
				margin: 0 auto;
				overflow: hidden;
			}

			.header {
				background: linear-gradient(45deg, #667eea, #764ba2);
				color: white;
				padding: 30px;
				text-align: center;
			}

			.header h1 {
				font-size: 2.5em;
				margin-bottom: 10px;
			}

			.header p {
				font-size: 1.2em;
				opacity: 0.9;
			}

			.controls {
				padding: 30px;
			}

			.input-group {
				display: flex;
				gap: 15px;
				align-items: end;
				flex-wrap: wrap;
				margin-bottom: 20px;
			}

			.input-field {
				flex: 1;
				min-width: 200px;
			}

			label {
				display: block;
				margin-bottom: 5px;
				font-weight: bold;
				color: #495057;
			}

			.generate-all-btn {
				padding: 12px 30px;
				color: white;
				border: none;
				border-radius: 8px;
				font-size: 16px;
				font-weight: bold;
				cursor: pointer;
				transition: transform 0.2s;
				min-width: 150px;
			}

			.generate-all-btn:hover {
				transform: translateY(-2px);
			}

			.libraries {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
				gap: 0;
			}

			.library {
				padding: 30px;
				position: relative;
			}

			.library:last-child {
				border-right: none;
			}

			.library-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				margin-bottom: 20px;
				padding-bottom: 15px;
				border-bottom: 2px solid #e9ecef;
			}

			.library-title {
				font-size: 1.5em;
				font-weight: bold;
				color: #343a40;
			}

			.library-badge {
				padding: 5px 12px;
				border-radius: 20px;
				font-size: 12px;
				font-weight: bold;
				color: white;
			}
			.qr-container {
				min-height: 280px;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				background: #f8f9fa;
				border-radius: 10px;
				padding: 20px;
				margin-bottom: 20px;
				border: 2px dashed #dee2e6;
				transition: all 0.3s;
			}
			.features {
				list-style: none;
			}

			.features li {
				padding: 8px 0;
				color: #6c757d;
				display: flex;
				align-items: center;
				gap: 10px;
			}

			.features .check {
				color: #28a745;
				font-weight: bold;
			}
			.features .cross {
				color: #dc3545;
				font-weight: bold;
			}

			.loading {
				color: #6c757d;
				font-style: italic;
			}

			@media (max-width: 768px) {
				.libraries {
					grid-template-columns: 1fr;
				}

				.library {
					border-right: none;
					border-bottom: 2px solid #e9ecef;
				}

				.library:last-child {
					border-bottom: none;
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="libraries">
				<!-- QRious -->
				<div class="library">
					<div class="library-header">
						<div class="library-title">QRious</div>
					</div>

					<div id="qrious-container" class="qr-container">
						<div class="loading">準備生成...</div>
					</div>
				</div>

				<!-- QRCode.js -->
				<div class="library">
					<div class="library-header">
						<div class="library-title">QRCode.js</div>
					</div>

					<div id="qrcode-container" class="qr-container"></div>
				</div>

				<!-- Kjua -->
				<div class="library">
					<div class="library-header">
						<div class="library-title">Kjua</div>
					</div>

					<div id="kjua-container" class="qr-container">
						<div class="loading">準備生成...</div>
					</div>
				</div>

				<div class="library">
					<div class="library-header">
						<div class="library-title">qr-style</div>
					</div>

					<div id="qr-style" class="qr-container">
						<div class="loading">準備生成...</div>
					</div>
				</div>
				<div class="library">
					<div class="library-header">
						<div class="library-title">qr-bwip</div>
					</div>

					<div class="qr-container">
						<canvas id="qr-bwip" width="260" height="260"></canvas>
					</div>
				</div>
			</div>
		</div>

		<!-- 載入三個庫 -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
		<script src="https://tw.hicdn.beanfun.com/beanfun/GamaWWW/MapleStory/Event/E20221223/assets/js/qrcode.min.js"></script>
		<script src="./js/kjua-0.10.0.min.js"></script>
		<script src="https://unpkg.com/qr-code-styling@1.9.2/lib/qr-code-styling.js"></script>
		<script src="https://unpkg.com/bwip-js/dist/bwip-js-min.js"></script>
		<script>
			try {
				// 直接畫到 canvas；bcid 指定條碼類型（這裡用 qrcode）
				bwipjs.toCanvas(document.getElementById("qr-bwip"), {
					bcid: "qrcode",
					text: "https://example.com",
					scale: 6, // 模組像素大小
					includetext: false // QR 一般不顯示文字
				});
			} catch (e) {
				console.error(e);
			}
			const qr = new QRCodeStyling({
				width: 260,
				height: 260,
				data: "https://example.com",
				qrOptions: { errorCorrectionLevel: "M" },
				dotsOptions: { type: "rounded" }, // dots: 'rounded' | 'dots' | 'classy'...
				cornersSquareOptions: { type: "extra-rounded" },
				backgroundOptions: { color: "#ffffff" }
				// image: "https://your.cdn/logo.png",    // 可選：logo
				// imageOptions: { hideBackgroundDots: true, margin: 6 }
			});
			qr.append(document.getElementById("qr-style"));
			const text = "https://maplestory.nexon.com/promotion/event/2024/20241010/event01";
			const size = parseInt(200);
			const errorLevel = "M";
			function generateAll() {
				generateQRious(text, size, errorLevel);
				generateQRCode(text, size, errorLevel);
				generateKjua(text, size, errorLevel);
			}

			// QRious 生成
			function generateQRious(text, size, errorLevel) {
				const container = document.getElementById("qrious-container");
				container.innerHTML = "";
				container.classList.remove("generated");

				try {
					const canvas = document.createElement("canvas");
					container.appendChild(canvas);

					const qr = new QRious({
						element: canvas,
						value: text,
						size: size,
						level: errorLevel,
						foreground: "#2c3e50",
						background: "#ecf0f1"
					});

					container.classList.add("generated");
				} catch (error) {
					container.innerHTML = `<div class="error-message">❌ 生成失敗: ${error.message}</div>`;
				}
			}

			// QRCode.js 生成
			function generateQRCode(text, size, errorLevel) {
				const container = document.getElementById("qrcode-container");

				try {
					// 使用 QRCode 構造函數
					const qrCode = new QRCode(container, {
						width: 320,
						height: 320,
						correctLevel: QRCode.CorrectLevel.M
					});
					setTimeout(() => {
						qrCode.makeCode(text.padEnd(220));
					}, 3000);
				} catch (error) {
					container.innerHTML = `<div class="error-message">❌ 生成失敗: ${error.message}</div>`;
					console.error("QRCode.js error:", error);
				}
			}

			// Kjua 生成
			function generateKjua(text, size, errorLevel) {
				const container = document.getElementById("kjua-container");
				container.innerHTML = "";
				container.classList.remove("generated");

				try {
					// 檢查 kjua 是否已載入
					if (typeof kjua === "undefined") {
						container.innerHTML = '<div class="error-message">❌ Kjua 庫未載入</div>';
						return;
					}

					const qrCanvas = kjua({
						text: text,
						size: size,
						ecLevel: errorLevel,
						fill: "#e67e22",
						back: "#ffeaa7",
						mode: "plain",
						mSize: 30,
						mPosX: 50,
						mPosY: 50,
						render: "canvas",
						crisp: true,
						minVersion: 1,
						quiet: 1
					});

					if (qrCanvas) {
						container.appendChild(qrCanvas);

						container.classList.add("generated");
					} else {
						container.innerHTML = '<div class="error-message">❌ Kjua 生成失敗</div>';
					}
				} catch (error) {
					container.innerHTML = `<div class="error-message">❌ 生成失敗: ${error.message}</div>`;
					console.error("Kjua error:", error);
				}
			}

			// 頁面載入時自動生成
			window.onload = function () {
				// 等待庫載入完成，增加等待時間
				setTimeout(() => {
					console.log("檢查庫載入狀態...");
					console.log("QRious:", typeof QRious !== "undefined");
					console.log("QRCode:", typeof QRCode !== "undefined");
					console.log("kjua:", typeof kjua !== "undefined");
					generateAll();
				}, 1000);
			};
		</script>
	</body>
</html>
