<!DOCTYPE html>
<html lang="zh-Hant-TW">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<link rel="stylesheet" href="https://necolas.github.io/normalize.css/8.0.1/normalize.css" />
		<link rel="stylesheet" href="js/jquery.slotmachine.min.css" />
		<script src="https://tw.hicdn.beanfun.com/jquery/jquery.min.js"></script>
		<script src="https://tw.hicdn.beanfun.com/jquery/jquery-migrate.min.js"></script>
		<script src="js/slotmachine.min.js"></script>
		<script src="js/jquery.slotmachine.min.js"></script>

		<style>
			* {
				padding: 0;
				margin: 0;
			}
			body {
				background-color: #66d4ff;
			}
			#app {
				font-family: "微軟正黑體";
				font-weight: bold;
				font-size: 0;
				text-align: center;
			}
			.box {
				width: 540px;
				margin: 24px auto;
				padding: 25px;
				background-color: rgba(245, 245, 245, 0.7);
				border-radius: 5px;
				font-size: 70px;
			}
			#planeMachine {
				height: 76px;
				overflow: hidden;
				display: inline-block;
				text-align: center;
				width: 100%;
			}
			.btn {
				color: #fff;
				background-color: #dc3545;
				border-color: #dc3545;
				padding: 16px 32px;
				font-size: 24px;
				line-height: 1.5;
				border-radius: 12px;
				margin-right: 12px;
			}
			.btn-init {
				background-color: #ffc107;
				border-color: #ffc107;
				color: #000;
			}
			.food.on {
				color: #dc3545;
			}
			a {
				font-size: 24px;
			}
			.video-box {
				width: 100vw;
				margin: 0 auto;
			}
			.video-box video {
				width: 100%;
			}
			@media screen and (max-width: 768px) {
				#planeMachine {
					height: calc(76 / 768 * 100vw);
				}
				.box {
					width: calc(540 / 768 * 100vw);
					margin: calc(24 / 768 * 100vw) auto;
					border-radius: calc(5 / 768 * 100vw);
					font-size: calc(70 / 768 * 100vw);
				}
				.btn {
					padding: calc(16 / 768 * 100vw) calc(32 / 768 * 100vw);
					font-size: calc(24 / 768 * 100vw);
					border-radius: calc(12 / 768 * 100vw);
					margin-right: calc(12 / 768 * 100vw);
				}
			}
		</style>
		<!-- Facebook Pixel Code -->
		<script>
			!(function (f, b, e, v, n, t, s) {
				if (f.fbq) return;
				n = f.fbq = function () {
					n.callMethod ? n.callMethod.apply(n, arguments) : n.queue.push(arguments);
				};
				if (!f._fbq) f._fbq = n;
				n.push = n;
				n.loaded = !0;
				n.version = "2.0";
				n.queue = [];
				t = b.createElement(e);
				t.async = !0;
				t.src = v;
				s = b.getElementsByTagName(e)[0];
				s.parentNode.insertBefore(t, s);
			})(window, document, "script", "https://connect.facebook.net/en_US/fbevents.js");
			fbq("init", "343788242861821");
			fbq("track", "PageView");
		</script>
		<noscript><img height="1" width="1" style="display: none" src="https://www.facebook.com/tr?id=343788242861821&ev=PageView&noscript=1" /></noscript>
		<!-- End Facebook Pixel Code -->
	</head>
	<body>
		<div id="app">
			<a href="https://discord.gg/TfsThAT">discord</a>
			<a class="" href="https://youtu.be/VUsujMbZ-J0">Youtube</a>
			<div class="video-box">
				<iframe width="560" height="315" src="https://www.youtube.com/embed/VUsujMbZ-J0?autoplay=1&mute=1&controls=0&playsinline=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay;; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
			</div>
			<div class="home__video">
				<!-- 修改 -->
				<div class="home__video-container video">
					<!-- 版頭youtube背景影片使用 -->
					<!-- 把data-video="" 空值就不會放影片 -->
					<div id="home-video" data-video="3giAe2BKg5U"></div>
				</div>
				<!-- 修改end -->
			</div>
			<div class="video-box">
				<video id="video" class="entry__video1" src="video/main-2.mp4" poster="images/og-image.jpg" muted loop playsinline webkit-playsinline preload="auto"></video>
			</div>
			<a class="playVideo" href="javascript:;">播放</a>
			<div class="box">
				<p>想吃什麼...</p>
				<div id="planeMachine"></div>
			</div>
			<button id="btn" class="btn">開始</button>
			<button id="init" class="btn btn-init">初始化</button>
			<button id="test" class="btn btn-init">測試</button>
		</div>
		<script>
			fbq("track", "ViewContent");
			fbq(
				"track",
				"Purchase",
				// begin parameter object data
				{
					value: 115.0,
					currency: "TWD",
				}
				// end parameter object data
			);
			var Foods = ["義大利麵", "米粉", "炒飯"];
			const el = document.querySelector("#planeMachine");
			Foods.forEach(function (v, i) {
				$("#planeMachine").append("<div class='food'>" + v + "</div>");
			});
			var machine;
			function Init() {
				if (!machine) {
					machine = new SlotMachine(el, {
						active: 0,
						delay: 450,
					});
				} else {
					machine.destroy();
					machine = new SlotMachine(el, {
						active: 0,
						delay: 450,
					});
				}
			}

			$("#btn").on("click", function () {
				machine.shuffle(5);
			});
			$("#init").on("click", function () {
				Init();
			});
			$("#test").on("click", function () {
				fbq("trackCustom", "ShareDiscount", { promotion: "share_discount_10%" });
			});

			var tag = document.createElement("script");
			tag.src = "https://www.youtube.com/iframe_api";
			var firstScriptTag = document.getElementsByTagName("script")[0];
			firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

			var player;
			function onYouTubeIframeAPIReady(e) {
				var videoId = document.getElementById("home-video").getAttribute("data-video");
				if (!videoId) {
					return false;
				}
				player = new YT.Player("home-video", {
					videoId: videoId,
					playerVars: {
						controls: 0,
						modestbranding: 0,
						showinfo: 0,
						rel: 0,
						loop: 1,
						start: 15,
						fs: 0, // 顯示全螢幕按鈕
						cc_load_policty: 0, // 隱藏字幕
						iv_load_policy: 3, // 隱藏影片註解
						autohide: 0, // 播放影片時隱藏影片控制列
					},
					events: {
						onReady: function (e) {
							// e.target.playVideo();
							e.target.mute();
							$(".home__video").addClass("start");
						},
						onStateChange: function (e) {
							if (e.data === YT.PlayerState.ENDED) {
								// player.playVideo();
							}
						},
					},
				});
			}

			$(".playVideo").on("click", function () {
				// player.playVideo();
				$("#video")[0].play();
			});
			$("#video")[0].play();
		</script>
	</body>
</html>
