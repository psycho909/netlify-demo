<!DOCTYPE html>
<html lang="zh-Hant-TW">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<style>
			#container {
				height: 100px;
				overflow: auto;
			}

			#element {
				background-color: lightgrey;
			}
		</style>
	</head>

	<body>
		<div id="targetDom" class="main">
			<div id="capture" style="padding: 10px; background: #f5da55">
				<h4 style="color: #000">Hello world!</h4>
				<img src="images/og-image.jpg" alt="" srcset="" />
			</div>
			<img src="" alt="" id="img2" />
		</div>
		<div class="btn">Click on the screenshot</div>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.1.5/html2canvas.min.js" integrity="sha512-oQzeC9gIS3sN3QCshVeDWiRCC2tJbR9lqj1rolUtQkGJJeA+7L54y/DVZf0+T3NDZuLOkbInugg7dVNwvcEGow==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<canvas id="canvas2" width="240" height="240" style="background-color: #808080"> </canvas>
		<p></p>
		<a id="download" download="myImage.jpg" href="" onclick="download_img(this);">Download to myImage.jpg</a>

		<script>
			$(".btn").on("click", function () {
				html2canvas(document.querySelector("#capture")).then((canvas) => {
					document.body.appendChild(canvas);
					var a = document.createElement("a");
					a.href = canvas.toDataURL("image/jpeg").replace("image/jpeg", "image/octet-stream");
					a.download = "image.jpg";
					var base64 = canvas.toDataURL("image/jpeg");
					$("#img2").attr("src", base64);
					a.click();
				});
			});
			var canvas = document.getElementById("canvas2");
			var ctx = canvas.getContext("2d");
			var ox = canvas.width / 2;
			var oy = canvas.height / 2;
			ctx.font = "42px serif";
			ctx.textAlign = "center";
			ctx.textBaseline = "middle";
			ctx.fillStyle = "#800";
			ctx.fillRect(ox / 2, oy / 2, ox, oy);

			download_img = function (el) {
				var image = canvas.toDataURL("image/jpg");
				el.href = image;
			};
		</script>
	</body>
</html>
